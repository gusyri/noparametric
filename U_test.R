# Load necessary libraries
library(nortest)

# Performance metrics for 200 tests on each controller (MPC and M2PC)
# Mean Squared Error (MSE) for MPC and M2PC controllers
mmse_mpc <- c(0.0659, 0.0646, 0.0654, 0.0647, 0.0652, 0.0651, 0.0663, 0.0642, 0.0644, 0.0635, 
              0.0642, 0.0642, 0.0634, 0.0651, 0.0663, 0.0651, 0.0663, 0.0638, 0.0642, 0.0646, 
              0.0639, 0.0639, 0.0630, 0.0653, 0.0636, 0.0655, 0.0628, 0.0639, 0.0653, 0.0637, 
              0.0650, 0.0636, 0.0659, 0.0638, 0.0675, 0.0660, 0.0643, 0.0655, 0.0666, 0.0648, 
              0.0649, 0.0664, 0.0648, 0.0646, 0.0642, 0.0651, 0.0659, 0.0649, 0.0645, 0.0642, 
              0.0655, 0.0645, 0.0637, 0.0655, 0.0642, 0.0650, 0.0638, 0.0615, 0.0631, 0.0658, 
              0.0639, 0.0654, 0.0637, 0.0646, 0.0643, 0.0661, 0.0630, 0.0651, 0.0647, 0.0651, 
              0.0664, 0.0639, 0.0638, 0.0659, 0.0652, 0.0651, 0.0643, 0.0647, 0.0661, 0.0653, 
              0.0655, 0.0650, 0.0658, 0.0647, 0.0637, 0.0633, 0.0650, 0.0647, 0.0651, 0.0655, 
              0.0661, 0.0649, 0.0648, 0.0638, 0.0641, 0.0652, 0.0659, 0.0647, 0.0655, 0.0644, 
              0.0667, 0.0651, 0.0631, 0.0662, 0.0648, 0.0651, 0.0657, 0.0652, 0.0662, 0.0654, 
              0.0649, 0.0641, 0.0664, 0.0661, 0.0662, 0.0653, 0.0659, 0.0659, 0.0649, 0.0644, 
              0.0645, 0.0654, 0.0672, 0.0657, 0.0658, 0.0673, 0.0646, 0.0654, 0.0656, 0.0642, 
              0.0664, 0.0666, 0.0661, 0.0667, 0.0666, 0.0656, 0.0647, 0.0667, 0.0662, 0.0651, 
              0.0658, 0.0672, 0.0669, 0.0663, 0.0659, 0.0673, 0.0654, 0.0662, 0.0662, 0.0663, 
              0.0669, 0.0652, 0.0674, 0.0661, 0.0657, 0.0662, 0.0654, 0.0665, 0.0658, 0.0650, 
              0.0633, 0.0661, 0.0667, 0.0663, 0.0652, 0.0646, 0.0672, 0.0668, 0.0675, 0.0654, 
              0.0676, 0.0650, 0.0644, 0.0647, 0.0667, 0.0655, 0.0675, 0.0651, 0.0670, 0.0671, 
              0.0671, 0.0671, 0.0666, 0.0661, 0.0672, 0.0678, 0.0661, 0.0670, 0.0649, 0.0660, 
              0.0670, 0.0655, 0.0650, 0.0652, 0.0654, 0.0657, 0.0663, 0.0678, 0.0673, 0.0671)

mse_m2pc <- c(0.1010, 0.0990, 0.0997, 0.1011, 0.0993, 0.1014, 0.1022, 0.1020, 0.1006, 0.1015, 
              0.1017, 0.1064, 0.1085, 0.1046, 0.1038, 0.1047, 0.1052, 0.1011, 0.1043, 0.1018, 
              0.1028, 0.1047, 0.1032, 0.1061, 0.1036, 0.1038, 0.1045, 0.1050, 0.1050, 0.1041, 
              0.1030, 0.1030, 0.1036, 0.1028, 0.0995, 0.1026, 0.1044, 0.1067, 0.1039, 0.1042, 
              0.1058, 0.1018, 0.1057, 0.1057, 0.1043, 0.1035, 0.1043, 0.1047, 0.1033, 0.1046, 
              0.1019, 0.1057, 0.1050, 0.1044, 0.1055, 0.1019, 0.1039, 0.1051, 0.1050, 0.1053, 
              0.1067, 0.1058, 0.1030, 0.1055, 0.1023, 0.1043, 0.1087, 0.1016, 0.1029, 0.1025, 
              0.0982, 0.1015, 0.1035, 0.1034, 0.1028, 0.1038, 0.1023, 0.1055, 0.1035, 0.1049, 
              0.1049, 0.1050, 0.1041, 0.1067, 0.1046, 0.1053, 0.1034, 0.1047, 0.1065, 0.1053, 
              0.1039, 0.1051, 0.1024, 0.1014, 0.1038, 0.1022, 0.1060, 0.1063, 0.1057, 0.1033, 
              0.0946, 0.0933, 0.0952, 0.0946, 0.0952, 0.0953, 0.0984, 0.0958, 0.1024, 0.0963, 
              0.0934, 0.0978, 0.0981, 0.1008, 0.0970, 0.0946, 0.0983, 0.0988, 0.0963, 0.0977, 
              0.0976, 0.0997, 0.0974, 0.0962, 0.0977, 0.0993, 0.1002, 0.1002, 0.0993, 0.1009, 
              0.1012, 0.1058, 0.0952, 0.1014, 0.1030, 0.0972, 0.0993, 0.0991, 0.1031, 0.0992, 
              0.1057, 0.1014, 0.1020, 0.1024, 0.1022, 0.1020, 0.0995, 0.0994, 0.1047, 0.1023, 
              0.1007, 0.1034, 0.1009, 0.1037, 0.1006, 0.1035, 0.1003, 0.1045, 0.1017, 0.1003, 
              0.1059, 0.1021, 0.0997, 0.1011, 0.0999, 0.1010, 0.1004, 0.0954, 0.1025, 0.1005, 
              0.1010, 0.1014, 0.1020, 0.1035, 0.1017, 0.0984, 0.0992, 0.1000, 0.1023, 0.1019, 
              0.0978, 0.1014, 0.0993, 0.1027, 0.0988, 0.0980, 0.1008, 0.1023, 0.1037, 0.1021, 
              0.1013, 0.1029, 0.1002, 0.1009, 0.1013, 0.0984, 0.1004, 0.1014, 0.1047, 0.0997)

# Total Harmonic Distortion (THD) for MPC and M2PC controllers
thd_mpc <- c(8.8152, 7.7468, 7.5784, 7.5891, 7.4253, 7.6038, 7.2374, 7.1580, 7.1383, 6.9817, 
             7.1642, 6.9355, 7.2197, 6.7333, 6.3693, 6.8197, 6.4540, 6.6149, 6.2612, 6.7000, 
             6.5115, 6.4462, 6.6151, 6.4133, 6.2596, 6.1290, 6.4114, 5.9077, 6.5159, 6.6448, 
             6.3399, 6.4195, 6.6121, 6.4379, 6.2807, 6.4946, 6.5186, 6.4619, 6.6445, 6.4298, 
             6.6836, 6.1900, 6.4389, 6.2865, 6.6723, 6.7357, 6.5767, 6.2419, 6.3254, 6.3165, 
             7.7250, 7.6123, 7.6801, 7.7728, 7.2248, 7.2324, 7.1966, 6.9840, 6.7912, 6.9478, 
             7.0815, 6.7850, 6.8219, 6.7680, 6.9846, 6.9205, 6.7340, 6.8862, 7.0463, 6.6508, 
             6.4937, 6.8809, 6.3592, 6.9139, 6.8890, 6.9792, 6.2956, 6.6448, 6.5083, 6.4293, 
             6.6329, 6.2922, 6.6157, 6.4723, 6.8689, 6.9892, 6.8182, 6.5578, 6.2955, 6.2295, 
             6.5447, 6.3155, 6.5037, 6.5017, 6.6315, 6.5955, 6.5824, 6.3552, 6.6006, 6.4086, 
             9.0630, 8.4915, 8.2688, 7.5051, 7.9510, 7.7392, 7.6473, 7.5152, 7.5878, 7.6986, 
             8.2208, 8.5961, 7.5304, 8.1013, 7.8702, 7.9875, 7.7309, 7.7966, 7.4386, 7.4211, 
             8.0163, 7.3836, 7.3559, 7.6591, 7.7114, 7.4363, 8.0662, 7.7402, 7.1373, 7.2594, 
             7.8066, 7.5465, 7.6315, 7.5319, 7.5384, 7.2231, 7.1618, 7.1336, 7.9831, 7.4998, 
             7.2569, 7.2850, 7.4620, 7.4136, 7.1978, 7.2025, 7.0257, 7.4733, 7.4733, 6.9569, 
             8.9310, 8.8654, 9.1126, 8.8638, 8.5992, 9.2271, 8.5405, 8.6613, 8.7293, 8.7609, 
             8.2959, 8.2746, 8.1410, 8.6239, 8.4356, 8.4646, 7.9819, 8.5651, 8.2204, 8.3335, 
             8.3808, 8.0879, 8.5371, 8.2435, 8.2605, 8.2896, 8.5631, 8.0469, 8.3456, 8.0598, 
             8.2303, 7.7119, 7.7622, 7.9522, 7.5970, 7.9324, 7.7062, 8.1488, 7.9200, 7.8510, 
             7.5682, 8.7107, 8.5726, 8.8964, 8.7511, 8.2805, 8.7457, 8.9688, 8.7030, 8.4204)

thd_m2pc <- c(8.8433, 9.0363, 9.0346, 9.2533, 8.9458, 9.2824, 8.8167, 9.4916, 8.7888, 9.5611, 
              8.9369, 8.6196, 8.7733, 9.3616, 9.0936, 9.2411, 9.2255, 9.4799, 9.3195, 9.3034, 
              8.7554, 9.3660, 9.7536, 9.1155, 8.9808, 9.2592, 8.9343, 9.3956, 8.8504, 9.2112, 
              9.2509, 9.1531, 9.4202, 9.4006, 8.9204, 8.8531, 8.7466, 8.9050, 8.8620, 9.0746, 
              9.2465, 9.6555, 9.0303, 9.2253, 8.7533, 8.8746, 8.8958, 9.6941, 9.4859, 9.6649, 
              9.3411, 9.4429, 9.2611, 9.5484, 9.5329, 9.3394, 9.2041, 9.5609, 9.5219, 9.2588, 
              8.6458, 9.1845, 9.3750, 8.8248, 9.6349, 8.8769, 9.2047, 9.3398, 8.8921, 8.6683, 
              9.3326, 9.4261, 9.6380, 9.5475, 9.1048, 8.9480, 9.2401, 9.3230, 9.1216, 9.4993, 
              9.2518, 9.2113, 8.9620, 9.1338, 9.2657, 9.0115, 9.1997, 9.1285, 8.7664, 8.9440, 
              9.4964, 9.1031, 8.6404, 9.3267, 9.0595, 8.5698, 9.0753, 9.0838, 9.1137, 9.0903, 
              8.4758, 7.7733, 8.8225, 8.4398, 8.1948, 8.5694, 8.8750, 8.0980, 8.3351, 9.0531, 
              8.2940, 8.6259, 8.7035, 9.0343, 8.2588, 9.0265, 8.6387, 8.4372, 8.8983, 8.6931, 
              8.9353, 9.4880, 8.9421, 8.8823, 8.7852, 8.9526, 9.1114, 9.0097, 8.6785, 8.7870, 
              9.1587, 8.5835, 9.5612, 8.5618, 8.8868, 8.5168, 8.6151, 8.9664, 9.3176, 8.7554, 
              9.4786, 9.1876, 8.7500, 8.9553, 8.6444, 8.7885, 9.4298, 9.3408, 8.9664, 8.6626, 
              9.1780, 9.3551, 8.7992, 8.9521, 9.2502, 8.9262, 8.7987, 8.6728, 8.3296, 9.2570, 
              8.7585, 9.2072, 9.0112, 8.6011, 8.9953, 8.8220, 8.5733, 9.0498, 8.4807, 9.0488, 
              8.9885, 9.0195, 8.8319, 8.2975, 8.6627, 8.9742, 8.9698, 9.2627, 8.7711, 8.6938, 
              8.9401, 9.1485, 9.3929, 8.9743, 8.4935, 8.3719, 8.9504, 8.5882, 9.1030, 9.4141, 
              8.9145, 8.5279, 9.3290, 8.7352, 9.1174, 8.6442, 8.9933, 8.9381, 9.0468, 9.0329)

# Calculate descriptive statistics (min, max, mean, SD) for each metric
descriptive_mse_mpc <- round(c(min(mse_mpc), max(mse_mpc), mean(mse_mpc), sd(mse_mpc)), 4)
descriptive_mse_m2pc <- round(c(min(mse_m2pc), max(mse_m2pc), mean(mse_m2pc), sd(mse_m2pc)), 4)
descriptive_thd_mpc <- round(c(min(thd_mpc), max(thd_mpc), mean(thd_mpc), sd(thd_mpc)), 4)
descriptive_thd_m2pc <- round(c(min(thd_m2pc), max(thd_m2pc), mean(thd_m2pc), sd(thd_m2pc)), 4)

# Create a data frame to organize the descriptive statistics
statistics_df <- data.frame(
  Statistic = c("Min", "Max", "Mean", "SD"),
  MSE_MPC = descriptive_mse_mpc,
  MSE_M2PC = descriptive_mse_m2pc,
  THD_MPC = descriptive_thd_mpc,
  THD_M2PC = descriptive_thd_m2pc
)

# Display the descriptive statistics table (similar to Table III in the article)
print(statistics_df)

# Selected samples of size 30 for normality tests
x1 <- c(0.0672, 0.0658, 0.0648, 0.0651, 0.0662, 0.0654, 0.0661, 0.0662, 0.0644, 0.0655,
        0.0652, 0.0670, 0.0659, 0.0639, 0.0658, 0.0642, 0.0642, 0.0638, 0.0650, 0.0647,
        0.0630, 0.0661, 0.0643, 0.0651, 0.0646, 0.0671, 0.0663, 0.0668, 0.0652, 0.0652)

y1 <- c(0.1041, 0.1037, 0.1024, 0.1045, 0.1067, 0.1002, 0.1014, 0.1051, 0.1013, 0.0988,
        0.1035, 0.1043, 0.0981, 0.1020, 0.1055, 0.1003, 0.0997, 0.1055, 0.1010, 0.1038,
        0.1028, 0.0984, 0.1057, 0.1034, 0.1009, 0.1002, 0.1008, 0.1037, 0.1038, 0.0997)

# Total Harmonic Distortion sample data
x2 <- c(6.3165, 6.3552, 6.4389, 6.4723, 6.4937, 6.5037, 6.5115, 6.5186, 6.5824, 6.6315,
        6.6836, 6.7000, 6.7680, 6.8219, 6.9355, 7.2231, 7.4211, 7.5319, 7.5319, 7.6038,
        7.6038, 7.9831, 8.0163, 8.0469, 8.0879, 8.2896, 8.7511, 8.7609, 8.8638, 9.0630)
y2 <- c(8.2588, 8.2940, 8.4398, 8.4935, 8.5835, 8.6259, 8.6728, 8.7035, 8.7885, 8.8319, 
        8.8433, 8.8620, 8.9343, 8.9381, 8.9421, 8.9504, 8.9742, 9.0115, 9.0343, 9.0346, 
        9.1216, 9.2041, 9.2113, 9.2255, 9.2518, 9.2592, 9.3326, 9.3398, 9.3929, 9.6349)

# Perform Lilliefors normality test for the MSE and THD samples (Table IV in the article)
pvalue_mse_mpc <- lillie.test(x1)$p.value
pvalue_mse_m2pc <- lillie.test(y1)$p.value
pvalue_thd_mpc <- lillie.test(x2)$p.value
pvalue_thd_m2pc <- lillie.test(y2)$p.value

# Display p-values for normality tests
cat("Lilliefors Test p-values:\n")
cat("MSE MPC:", pvalue_mse_mpc, "\n")
cat("MSE M2PC:", pvalue_mse_m2pc, "\n")
cat("THD MPC:", pvalue_thd_mpc, "\n")
cat("THD M2PC:", pvalue_thd_m2pc, "\n")

# Create a data frame combining THD values for ranking (Table V in the article)
combined_df <- data.frame(
  Value = c(round(x2, 2), round(y2, 2)),
  Controller = rep(c("MPC", "M2PC"), each = length(x2))
)

# Sort by THD values and add ranking
combined_df <- combined_df[order(combined_df$Value), ]
combined_df$Ranking <- 1:nrow(combined_df)

# Display the combined THD ranking table
print(combined_df)

# Perform the Mann-Whitney U test (Wilcoxon rank-sum test) to compare THD distributions
mw_test_result <- wilcox.test(x2, y2, alternative = "less", paired = FALSE)
cat("Mann-Whitney U Test p-value (THD comparison):", mw_test_result$p.value, "\n")
